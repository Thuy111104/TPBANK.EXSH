<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Vote Tool – Client Side Request</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 120px; }
    button { padding: 10px 20px; margin-top: 10px; }
    pre { background: #eee; padding: 10px; white-space: pre-wrap; }
  </style>
</head>
<body>

<h2>Gửi Request Tới API từ trình duyệt</h2>

<label>Nhập Cookie:</label><br>
<textarea id="cookieBox"></textarea><br>

<button onclick="sendRequest()">Gửi Request</button>

<h3>Kết quả:</h3>
<pre id="output"></pre>

<script>
async function sendRequest() {
    const cookieRaw = document.getElementById("cookieBox").value.trim();
    if (!cookieRaw) return alert("Không có cookie");

    document.getElementById("output").textContent = "Đang gửi request...";

    const url =
      "https://api.fchoice.vn/vote-token.htm" +
      "?callback=jQuery3510026807873160589635_1764507964293" +
      "&m=set-vote&sign=27_82&award=27&member=82&typeId=1" +
      "&_=1764507964296";

    try {
        // Chia cookie thành object để gửi
        const cookieObj = {};
        cookieRaw.split(";").forEach(p => {
            const [k, v] = p.trim().split("=");
            if (k && v) cookieObj[k] = v;
        });

        // Tạo string cookie lại
        const cookieHeader = Object.entries(cookieObj)
            .map(([k,v]) => `${k}=${v}`)
            .join("; ");

        const res = await fetch(url, {
            method: "GET",
            mode: "cors",
            credentials: "include", // cho phép gửi cookie
            headers: {
                "Accept": "*/*",
                "Referer": "https://fchoice.vn/",
                "User-Agent": navigator.userAgent,
                "Cookie": cookieHeader
            }
        });

        const text = await res.text();
        document.getElementById("output").textContent = text;

    } catch (err) {
        document.getElementById("output").textContent = "Lỗi: " + err;
    }
}
</script>

</body>
</html>
